{"version":3,"sources":["DatePicker.js","Loading.js","_config.js","App.js","index.js"],"names":["DatePickerContainer","props","updateDate","date","setDate","useState","Date","className","onChange","value","clearIcon","autoFocus","Loading","key","l3Topo","require","getL3","topojson","addDays","days","result","getDate","geomFilter","filter","geometry","features","getFilter","dateFilter","dates","gte","lte","and","addPlanetLayer","map","url","addSource","type","tiles","minzoom","maxzoom","attribution","addLayer","id","source","layout","visibility","getPlanetTileUrl","async","auth","login","setKey","footprints","items","search","types","queryFilter","tileUrl","forEach","fp","mapboxgl","accessToken","App","mapContainer","useRef","setMap","promiseInProgress","usePromiseTracker","useEffect","Map","container","current","style","center","zoom","on","data","paint","addL3Layer","planetTileURL","trackPromise","remove","ref","DatePicker","getLayer","removeLayer","getSource","removeSource","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"mgLAuBeA,MApBcC,IAC3B,MAAM,WAAEC,GAAeD,GAChBE,EAAMC,GAAWC,mBAAS,IAAIC,MAOrC,OACE,qBAAKC,UAAU,aAAf,SACE,cAAC,IAAD,CACEC,SARcL,IAClBD,EAAWC,GACXC,EAAQD,IAOJM,MAAON,EACPO,UAAW,KACXC,WAAW,OCbJC,MAHC,IACP,qBAAKL,UAAU,WCHxB,MAEMM,EAAM,mCCYNC,EAASC,EAAQ,IACjBC,EAAQ,IAAMC,IAAiBH,EAAQ,iBAEvCI,EAAU,CAACf,EAAMgB,KACrB,IAAIC,EAAS,IAAId,KAAKH,GAEtB,OADAiB,EAAOhB,QAAQgB,EAAOC,UAAYF,GAC3BC,GAGHE,EAAaC,IAAOC,SAAS,WAAYR,IAAQS,SAAS,GAAGD,UAE7DE,EAAavB,IACjB,MAAMwB,EAAaJ,IAAOK,MAAM,WAAY,CAC1CC,IAAK1B,EACL2B,IAAKZ,EAAQf,EAAM,KAErB,OAAOoB,IAAOQ,IAAI,CAACJ,EAAYL,KAG3BU,EAAiB,CAACC,EAAKC,KAC3BD,EAAIE,UAAU,SAAU,CACtBC,KAAM,SACNC,MAAO,CAACH,GACRI,QAAS,EACTC,QAAS,GACTC,YAAa,qBAEfP,EAAIQ,SACF,CACEC,GAAI,SACJN,KAAM,SACNO,OAAQ,SACRL,QAAS,EACTC,QAAS,GACTK,OAAQ,CACNC,WAAY,YAGhB,OAwBEC,EAAmBC,gBACjBC,IAAKC,MD7EC,qBACG,yBC6ETD,IAAKE,OAAOrC,GAClB,MAAMsC,QAAmBC,IAAMC,OAAO,CACpCC,MAAO,CAAC,gBACR/B,OAAQgC,IAEV,IAAIC,EAAU,iDAId,OAHAL,EAAWM,SAASC,GAAQF,GAAWE,EAAGhB,GAAK,MAC/Cc,GAAW,4BACXA,GAAW3C,EACJ2C,GAGTG,IAASC,YDtFP,6FCgIaC,MAxCH,KACV,MAAMC,EAAeC,oBACd9B,EAAK+B,GAAU3D,mBAAS,OAEzB,kBAAE4D,GAAsBC,8BA2B9B,OAlBAC,qBAAU,KACR,MAAMlC,EAAM,IAAI0B,IAASS,IAAI,CAC3BC,UAAWP,EAAaQ,QACxBC,MAAO,qDACPC,OAAQ,EAAE,MAAO,OACjBC,KAAM,IAUR,OARAxC,EAAIyC,GAAG,QAAQ3B,UAxDA,EAACd,EAAK0C,KACvB1C,EAAIE,UAAU,KAAM,CAClBC,KAAM,UACNuC,KAAMA,EAAKlD,SAAS,KAEtBQ,EAAIQ,SAAS,CACXC,GAAI,KACJN,KAAM,OACNO,OAAQ,KACRC,OAAQ,CACN,YAAa,QACb,WAAY,SAEdgC,MAAO,CACL,aAAc,MACd,aAAc,MA0CdC,CAAW5C,EAAKjB,KAChB,MAAM8D,QAAsBC,uBAC1BjC,EAAiBpB,EAAUR,EAAQ,IAAIZ,MAAS,MAElD0B,EAAeC,EAAK6C,MAEtBd,EAAO/B,GACA,IAAMA,EAAI+C,WAChB,CAAChB,IAGF,gCACE,qBAAKzD,UAAU,gBAAgB0E,IAAKnB,IACpC,cAACoB,EAAD,CAAqBhF,WA5BN6C,UACjB,MAAM+B,QAAsBC,uBAAajC,EAAiBpB,EAAUvB,KAChE8B,EAAIkD,SAAS,WAAWlD,EAAImD,YAAY,UACxCnD,EAAIoD,UAAU,WAAWpD,EAAIqD,aAAa,UAC9CtD,EAAeC,EAAK6C,MAyBjBb,EAAoB,cAAC,EAAD,IAAsB,S,MCzHjDsB,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.86a9ffd5.chunk.js","sourcesContent":["import React, { useState } from \"react\";\nimport DatePicker from \"react-date-picker\";\n\nconst DatePickerContainer = (props) => {\n  const { updateDate } = props;\n  const [date, setDate] = useState(new Date());\n\n  const changeDate = (date) => {\n    updateDate(date);\n    setDate(date);\n  };\n\n  return (\n    <div className=\"datePicker\">\n      <DatePicker\n        onChange={changeDate}\n        value={date}\n        clearIcon={null}\n        autoFocus={true}\n      />\n    </div>\n  );\n};\nexport default DatePickerContainer;\n","import React from \"react\";\n\nconst Loading = () => {\n  return <div className=\"loader\"></div>;\n};\nexport default Loading;\n","const email = \"becker6@stolaf.edu\";\nconst password = \"LxfYfvWEZt7L.ds\";\nconst key = \"2b4881ccd4f94f10a8a48c508f395305\";\nconst mbAccess =\n  \"pk.eyJ1Ijoic2hhbmU5OGMiLCJhIjoiY2ttbzNidDdzMjE0ODJ3bDhsNnJmNWYxayJ9.WLY89SSw0VDm3uH0C6WtaQ\";\n\nexport { email, password, key, mbAccess };\n","import mapboxgl from \"mapbox-gl/dist/mapbox-gl-dev\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { trackPromise, usePromiseTracker } from \"react-promise-tracker\";\n\nimport auth from \"@planet/client/api/auth\";\nimport filter from \"@planet/client/api/filter\";\nimport items from \"@planet/client/api/items\";\nimport * as topojson from \"topojson-client\";\n\nimport DatePickerContainer from \"./DatePicker\";\nimport Loading from \"./Loading\";\n\nimport { email, password, key, mbAccess } from \"./_config\";\n\nconst l3Topo = require(\"./data/L3PermRoute.json\");\nconst getL3 = () => topojson.feature(l3Topo, \"l3PermRtMerge\");\n\nconst addDays = (date, days) => {\n  var result = new Date(date);\n  result.setDate(result.getDate() + days);\n  return result;\n};\n\nconst geomFilter = filter.geometry(\"geometry\", getL3().features[0].geometry);\n\nconst getFilter = (date) => {\n  const dateFilter = filter.dates(\"acquired\", {\n    gte: date,\n    lte: addDays(date, 1),\n  });\n  return filter.and([dateFilter, geomFilter]);\n};\n\nconst addPlanetLayer = (map, url) => {\n  map.addSource(\"Planet\", {\n    type: \"raster\",\n    tiles: [url],\n    minzoom: 0,\n    maxzoom: 19,\n    attribution: \"Â© Planet Labs\",\n  });\n  map.addLayer(\n    {\n      id: \"Planet\",\n      type: \"raster\",\n      source: \"Planet\",\n      minzoom: 0,\n      maxzoom: 19,\n      layout: {\n        visibility: \"visible\",\n      },\n    },\n    \"l3\"\n  );\n};\n\nconst addL3Layer = (map, data) => {\n  map.addSource(\"l3\", {\n    type: \"geojson\",\n    data: data.features[0],\n  });\n  map.addLayer({\n    id: \"l3\",\n    type: \"line\",\n    source: \"l3\",\n    layout: {\n      \"line-join\": \"round\",\n      \"line-cap\": \"round\",\n    },\n    paint: {\n      \"line-color\": \"red\",\n      \"line-width\": 2,\n    },\n  });\n};\n\nconst getPlanetTileUrl = async (queryFilter) => {\n  await auth.login(email, password);\n  await auth.setKey(key);\n  const footprints = await items.search({\n    types: [\"PSScene4Band\"],\n    filter: queryFilter,\n  });\n  let tileUrl = \"https://tiles.planet.com/data/v1/PSScene4Band/\";\n  footprints.forEach((fp) => (tileUrl += fp.id + \",\"));\n  tileUrl += \"/{z}/{x}/{y}.png?api_key=\";\n  tileUrl += key;\n  return tileUrl;\n};\n\nmapboxgl.accessToken = mbAccess;\n\nconst App = () => {\n  const mapContainer = useRef();\n  const [map, setMap] = useState(null);\n\n  const { promiseInProgress } = usePromiseTracker();\n\n  const updateDate = async (date) => {\n    const planetTileURL = await trackPromise(getPlanetTileUrl(getFilter(date)));\n    if (map.getLayer(\"Planet\")) map.removeLayer(\"Planet\");\n    if (map.getSource(\"Planet\")) map.removeSource(\"Planet\");\n    addPlanetLayer(map, planetTileURL);\n  };\n\n  useEffect(() => {\n    const map = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: \"mapbox://styles/shane98c/ckg018j041tc119p6tgqsg9mm\",\n      center: [-94.68, 46.72],\n      zoom: 6,\n    });\n    map.on(\"load\", async () => {\n      addL3Layer(map, getL3());\n      const planetTileURL = await trackPromise(\n        getPlanetTileUrl(getFilter(addDays(new Date(), -1)))\n      );\n      addPlanetLayer(map, planetTileURL);\n    });\n    setMap(map);\n    return () => map.remove();\n  }, [setMap]);\n\n  return (\n    <div>\n      <div className=\"map-container\" ref={mapContainer}></div>\n      <DatePickerContainer updateDate={updateDate} />\n      {promiseInProgress ? <Loading></Loading> : null}\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}